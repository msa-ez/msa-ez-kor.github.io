<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Choreography Saga - msaez</title><meta name="gridsome:hash" content="02557756aae45533b803a789aa97397039f5d114"><meta data-vue-meta="ssr" charset="utf-8"><meta data-vue-meta="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-meta="ssr" key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-meta="ssr" key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/templates-language/springboot-java-template/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/setup-on-prem/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/si-gpt/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/templates-language/python-template/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/on-prem-inst/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/operation/ops-deploy-diagramming-advanced-hpa/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/operation/ops-deploy-diagramming-advanced-ingress/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/operation/ops-deploy-diagramming-advanced-istio/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/operation/ops-deploy-diagramming-advanced-pvc/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/operation/ops-deploy-diagramming-basic-objects/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/model-driven/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/marketplace/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/k8s-modeling/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/started/key-features/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/infrastructure-modeling/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/understanding-jpa-based-single-microservice/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/templates-language/go-template/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/google-drive-examples/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/understanding-template-structure/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/event-storming-tool/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/unit-test/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/token-based-auth/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/started/event-storming-learning/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/template-editor/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/template-structure/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/template-syntax/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/cloud-ide-tool/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/development-practice/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/tutorial/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/started/domain-driven/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/chat-gpt/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/example-scenario/online-lecture/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/tool/attending-lectures/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/pub-sub/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/pubsub-deadline/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/pubsub-idempotency/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/contact/question/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/oauth2with-keycloak/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/ops-docker/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/orchestration-saga/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/monolith-2-misvc/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/example-scenario/library-system/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/mock-server/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/kafka-scaling-concurrenty-handling/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/kafka-retry-dlq/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/kafka-basic/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/kafka-connect/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/kafka-scaling/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/example-scenario/food-delivery/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/helper/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/for-loop/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/gateway/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/creating-custom-template-1/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/designing-template-helper/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/dp-cqrs/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/dp-frontend/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/dp-graphql/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/business/ddd-google-drive/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/business/eventstorming-fooddelivery/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/conditional-statement/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/custom-template/custom-template/"><meta data-vue-meta="ssr" key="og:url" name="og:url" content="undefined/development/choreography-saga/"><meta data-vue-meta="ssr" name="description" content="undefined"><meta data-vue-meta="ssr" key="og:title" name="og:title" content="Choreography Saga"><meta data-vue-meta="ssr" key="twitter:title" name="twitter:title" content="Choreography Saga"><meta data-vue-meta="ssr" key="og:description" name="og:description" content="undefined"><meta data-vue-meta="ssr" key="twitter:description" name="twitter:description" content="undefined"><meta data-vue-meta="ssr" key="og:type" name="og:type" content="website"><meta data-vue-meta="ssr" key="twitter:card" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" key="og:image" name="og:image" content="undefined/logo.jpg"><meta data-vue-meta="ssr" key="twitter:image" name="twitter:image" content="undefined/logo.jpg"><link data-vue-meta="ssr" rel="icon" href="data:,"><link data-vue-meta="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.f0886199c685a75a52fccefb5e72c094.png"><link data-vue-meta="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.f0886199c685a75a52fccefb5e72c094.png"><link rel="preload" href="/assets/css/0.styles.61c64cea.css" as="style"><link rel="preload" href="/assets/js/app.1d5c79dd.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--markdown-page-vue.43dc86ca.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.771cb3e7.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.a919d8e4.js"><link rel="prefetch" href="/assets/js/search.20b31559.js"><link rel="prefetch" href="/assets/js/vendors~search.1cb8046c.js"><link rel="stylesheet" href="/assets/css/0.styles.61c64cea.css"><noscript data-vue-meta="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="font-sans antialiased text-ui-typo bg-ui-background"><div class="flex flex-col justify-start min-h-screen"><header class="sticky top-0 z-10 w-full border-b bg-ui-background border-ui-border"><div class="py-2 border-t-2 border-ui-primary"><div class="container"><div class="flex items-center justify-between -mx-2 sm:-mx-4"><div class="flex flex-col items-center px-2 mr-auto sm:px-4 sm:flex-row"><a href="/" title="Home" class="flex items-center text-ui-primary active"><img src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 120 64' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-37afcb0017f229c304bfe602273e7d7c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-37afcb0017f229c304bfe602273e7d7c)' width='120' height='64' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAYAAADvVd%2bPAAAACXBIWXMAAC4jAAAuIwF4pT92AAATu0lEQVRo3sVZB3RU15lWIxhscMtunHhd8EkcJzFusb1xwMaAuoQkpFEFUWQwzXEMAQSYElFEkVCbGUmjikZdIJBAqIxmRgUJVRAqmGLABQdwTBDqZebdb/97Z0YIO1nvnrN7mHO%2b89/35pX5vvu3e8fKij69eQ4C48ffg7UZNgK5DrY9ufZ2wtJ5qwfw0cirrDSKahuCrRk0rrKuUFRb05h/Z1VhukZcP378g09vnr2VmZwtR4/Z8nNE9Ed/DAlhRfdM%2bS7X/QXkv/rWtrQ6R2cVW%2bSVNBDkoRoK9EwaCvBMGvQn60fwJcgIPnRuvkfSkBeNPWns4aEadCfrRseudN5lvmrAZU6SZJ%2bobA/Ry3XLyhXV7xPBXxGRh/%2b731PxQ3FsK%2bTi2Fojrx4TQtievP8BQSJHBJ8h%2bzrBje5ZQTaMhEulcTmN2%2bn7G925zgNS/n9K0enF3S5qwC8T8LFAfT9kZojjDMDbgkP34ENwIySnXkNraiN0CfUgAQbph39DaCQyeWT3EuHlhDk0/hXZx36MDxdovOUEnyC8SiQcyS4mbOnNtY8nW0K2lfAFobc/3wGGo05AsTNwwpXgBlbsIs4NHXZEb74zjPnvQJ2ROmKvgmF%2bUr%2bBZpQwZKDZFdaLjt0T%2bgyO8l6jo7zP6KzoNXok9hvpvJG8xUjXE8iqBgXck4alQ8ozxiq5zkAeIFUqa6BPqENNUiPqU1twOu0M6lKaUa06DRJghEhdJ9tMOMzFISwjOBB%2bTZh6T4Tq%2b1w4khU5Y6DAETjuQsRcTJbIGY%2b5YOiIM/oLnECCMAoJqTfP0XA3Z67hTsYfCTMMPbkORvpO6s51Yoa8P7JydTgcVWBeSf2MCDEiT3aI7ACzVwyyoBywtSVg60%2bCfXQcbH46mKNigK7n1wyJe4g8m0fH3nTPYUUj08n1jGafaUyQiKiRrIGsoeSgxngiUiOVx%2bpRlViPWhKHi3I6tZVEahXnuDiEvxHOE%2baYQ8DGIsBfOGma5REiQoTsDdxyknfVfzT2Z8%2bQutUzGHkI4yLczX6fjRx1ZWjczFC3FgN5c0iYuexunhNG8mayM1l/Zm4qIycCQSZpCB6JA5iXNIq4GiNi0ouxdsNWfLx2Azbt2IeUomZsLQOclIMgTwCJABIANPsIVPWgRFGLSnkVd39OBERaCFEep4dGXsM6T1xkFzRXWP2hFlYarZPoOyMXhgtEiZFbqVJRA62yFo3pbXR/tbNZAFshAM2gB3djImck8pwkiDyjmWcjDXvw93oFjLXr0Zv9Pj%2bPkWIvdGiS4ecfiDVr/oRvT8WiP3c2unMd2WDeLFzNCWZ%2bSXfZPNUwF0CQcoofRkLNABb6eYJeeR9%2bYm2FvZFyfFQEOCv76XqTAK5JI1iWeJtIVnHS4wWgcRU0cdVo03ZgzUdr4ObuhqK8YjTlnEVptNbiKXQvt0IwSdwrckjVS9/zAPtX%2b4h0r2WGcx2I0CzcOhUHV68ATHniKWzf8VdIdZvxj5RXITXtwRyne0T2hG0FqpbhH%2br30Jdnj9u57vgg%2bSu4qIxEZgDOij6sJnI790aZ77HGc88/D4c5s/DitKfFueAAH%2bypAubG9QnBvEgAZ/KYtYk3QBVAkK8wk9coq3EiogIXyj/Hnz7%2b09jvePq5X%2bBM5TlUxJgEEteaReMC8NxB9ibhSbMA1pYk%2bBTh9iDlAB7Ld7LeB8p9kZW4995M2U5GV2UyjHnv4FZNFJ5%2b/sWx75xc3IGG7ejOeAc9FAaDebOxPvUcnFQM3skDsCdSYVrAV%2bYtrqe3Iv%2b4Hse%2bBGLKbmK3IhcJFX%2bDd6oB81Q8bIaEAE4kwLaEL1Aj16LcLAAnw12/WtUA/YkqTJg4QQg6wW6CePaRjKOoS21GWaxuPHnuAcYauodE6Rgrg5ZEaK77nZYwuJNJAlQEID0uTDx00kMThd26eQNQvxJtxfsxYfLj45R/EX%2bvjUZ/9kx05zljNG8mDqSVw0FF5SypHw7yPoRSjK9eY5otG1tbTJ/%2bCjaHxyO%2b/BtENwMOCRLcE/oFeUqaYx5wIP7iPQHGzf4l3VX4%2bvmanmdjAzs7O7M3huNsQSdORlWOCVAhNwlwKrmJH580l0BrSx9gY06EpbwSmAVgqAhEauxO8VA7O1thX3jpFaArGcXJ2%2bnYZlwc/wS1R6IgFbngdraj8JJDhw5hLglApVAkQK9UBrXmMn75H0/cF///9thD%2bGjVCiTV9sFNNUKxPyBEsOQAaoJQZRaAk%2bEzW5/WguL847CyNj3DP8Afb775phgHBgbifNlllERqxvKFWQgDrwpklUIARZWtEIB3fOYwUPLSx7P/ncxZgCYIqqi/iodOmGAnwMe1ZflIVR4Q45df/h0ef/wxMY4O/xTQLsJ3mbNFL1Cq3sdLIcWzKam5xvcjOJshobgD/rL5eOZnj90nxKrlS7GbwsRe3i9yABeAyiCylS0iB5TLq8Xsl0RocKn6Khwc7cV9EydOxMWOi/Dy9BLHr73xKs5VdKIsalwIiKpRZeA9Ax1vMMe/ncUDzALYrxWl0CQAQ%2bVCKCO2i4c%2b9dTP4OnhIcZLQ5ZhY2ioGIeGbsK7774rxgEBgZQHNuN2xkyM5L%2bHlqy1cFeNjlUB14RBEgDYcwpQtALyir9jx/54/PQJUyg9%2begkJJR9SbNOiVM1IMjLVP04qjgNrVwv4v9kdCWas9qQmZo1JpyrmytGuw1YtWKVOJ7y6BToi2qgU9bR7OvHl00j7w/oOf7fL4G25hDwko5ZQoALEIy4/dtMbvrTJ3HsWLGItUcfnYpp06aJ88XHCvHh8uVi/NL036O7LhI9WTOpL5iNKzmLIEvqhQfVcj77Kw8DyowiBPnLsDu%2bENHlt1F%2b5hZeefm34v5HH54A5YmLmJfCSIB%2bCodhLErsRin1ABpz7Jce1OJCzWW88ebrYwLYUfKbNu15PPPsM2PnUpSpaFJTOYzRmgQwlUGmja/lx3%2bwlECzBzjYmEPgDXMZxJ3M9xh35%2bjwreKBDz00Cd9c6YCri5M56ViLHHCp/ggU%2b03XTJryBGs7GQdDoT3rz7dnd3Jd2AfJX1MzY2C8tMnrgHffnm66n/D8009i6iOTxn60y5wZiKk2Yq58kHknk8ckG9kq1W1mnn1WElXJ2g6fR1yU3PQMaxtMpOQ8cfLEsWfY2ppy1bpP1qG96AKoQxyrAryF1pjWEc9YSqBoh3vNy1kS4t8pHLoHqKcnASRol7DI3Z9ayOFWSzYKUvaPvWzi1J%2bhpzUJukyRKBlHbPgmSOXB0lfy6axAsYknM9ENcg9YXgCosk7gtd88B7txsT/RlsjPnQl15efwPcTYvERqiVW8ctyR1sZclKoVep4AWUVsFdprOjHtxWlj9xYVFAt3z07JwY6tOzB58mRTWXZ2wnmNSIRi5ikEJF0CD4mqL%2bj4ke/3AJZ22I7GF0YKnXFH/a4E/VIWtuUT88sm4sLJfRhqjMCiZWvw%2b7dnQBF7EJJ%2bNb6sjMD7rv7s3VmzkZGWIn2e4YfCXZ6QJXZL85JHqAz2Md4LuJAIHx6h2NcPIiK7CfsT8nFAVYD4oy2IqzVAdshIOWOAucXdwtwdTdI721vx6f561MRXSWWiqalmLaVtKMopRtS%2baCTGJ6L95GfQxp0S/f71MzcoDF8Sv3fq41PRUNLMKuNqxMxTCzzK1wZE%2bizn2nTo3L29Ab7eH/OCXIdyvrojDzCgcjGRjMKvf/caZEEhuF4bj%2bH8WaIbNDbuAXTL0JM5A/0ngjHaEoEbpaHSxewQtOz%2bzTerFU2pjqnU28cbpbnxYPbxIHIGeCTcxaK0r7D%2byDdYkAsEZQGeKcCcGAluSgN5DHWCu65Is7e04q3QlvbMyLq6hsRGEBGpMo5qeUw1TiU3oyW7HWfyO6gk6kWio4UQTqkboSmqRPS%2bGGzaFMpOVzSxshgdjkeVGYoiS8V1ZHdxnof3FtmMXwqLRsg8TuCVQCyG8p1Yb00Yhhv2AY3bMXDMB3ezqd9Xz8DdjD9wkajrcyQRZqEn/Q%2bs/q/TUfHpa7i2Y/J7ATmG5esKv8POww2G5JJjrESbgDP12/F162o20uWDr5rWMO%2b0a8yn8DjzP6JBwJEa5lvQAN%2b8s8w9vgLOUSfhrM5aWnjo%2bMky9SkUJdJqL0HLSuN1KJPrGFUDgXEZHnwlSJ0ea8lpZ53FF3E0%2bgSTr08YTd2WAcWGxMHotfLFltnftTL8BxsetuY8sMHSC4hFURatANXvsDu8xc2ZLdYJRJrgxFeGUm%2bBg9RX7MJ6S93ZdfKcm1r324aLvvqecwu6Bzr8YOhwZaxjDkPnbOAzdxjPe8Jw3oN1t4Vg5dFTWFC9E0uqd7HF1buwuHo3FmjD2ELdHgTrw43Bur1scdVBLNVFsg%2b0B7FCE81Wl8fiz6UKdlRVYdDKawyU3fmqT7q3OtQxnvmPR5Qb4zcmSenbMxEfmtSYuDnlRc6vOaPdOnz1/vs3Q3pMe34WD5hvpFJI5EfFyjDPicPA1/9mUfi6H/0FDhjimyM6dwx/JmPD52Ug4ky67A9c8QEuuAGfyxi%2bDgFuUvt8YyOGaeYHO2VsiOxohz/bUZrd76eNYot1kQjWRrIg3QGsaVVhdUsiW96oQMjpWCyoiWB%2bleEkyAG2UH8AgVX72BJ9JDTqOjSmnEVtciP0CfWoVIryxpOdQRd/auRY5EmoNqciYVNypGWSlRtVdiSGZXzfbpDYD7SUwkGqAhyjtC7grTHfFLFskBiPibUCx0BPtv3XfSddLnHyQ50%2bBBkG2z0Zu7bG2H01RTpTk4Dighi2J2wD2xW2DX1XDmCkcx4b6PQDzntJmQ1/OS/TRklLiViQbj%2bLbi6APCuZRWUmQHE4nSmLM5i6rpjtbctDYCV5gz6SPCUSIdqDdwuTyg9o42oyyANqiTjP7AN8rc/zQ2P6WaRtU9%2bKWadws5An4rYW4hYRvh8C1mb7C8JNwrdUEtvJaqk6ZJDdTZ7C9wE9qGN8m1z/%2bW8/fMVu6Jz3NCI/NEoiDLR7M1wJRIM%2bFT9/5mXKxrb3St0jv8D1LjWkC57o7/BlJADyGz8xkAAsuHIvVjQpWUZR3n2t8aQJEzHJegKiE%2bVY15aKQE24tLQumnvD1fv29xRVD5EAz9KMzqCMv6AkWrOZZv9Z/l3iphRbImxtFsGKPOKfbxJaNkaJHN8ZfpaOn6Txj253D1/yfWi4S3YFl/3Q1%2bYp4cYKpCbsFgR%2b%2b9uXUHQkFV2tJzB6tw34ZiMGzrmxwS7hAexQw3r4aKNAHsACdfsQ1VoAZX4aEnLTsHLlyjEhFNkpWNOSiCDNXuPS%2bhgs0kV05aaW2DUcbLQ5mJfzL3%2bjZdZ/lPz4rfF/5hm8U%2bTrBfresl1u03vUyXqg1kOEDQmgwxcB3AOMuBbIasqU4oe//tprqNEeQUzEpwhe4IfTmjjgajDr455yfj7i60MZCUAxfQCL9BHMXxOO1W0q6L48g7feMK3swnaGIfryccjKKUnqI408LwTrIk7z966siLVWqQutzP8BUFdXZVOpqLE9GVNpm/xpuhAmb0/hjxO/rxka/ydI7g//IOkR5%2bytyO05caEwxb4KXwVisENmYBe92NWzKkx%2b5Kc/2PZKT9oPXF%2bBvnNeYF3z2cG6LYxCAEIASoABur3Iv6DHrHdmiuuXLQlB2tVK%2bFRw8hFE/IAxpCGOi1XO30vWms5ZBBC/nxKgFVUBq5xdBeK4cP/x/59/ZYY7ZWMCkP2ECzDU6WsY6XRF3zUFXvilqedXxh3A9YslGL7TAgwVstHz89kgJUzpMx8WXreN%2bVJ5W0qzL9PshvqaDouCFor7fLy8UXyjCX41%2b3gCFB5CZA0fNMZxIXL5e8nacAEeyIdI3xOgU%2baKq/4Y6vI1Dp5zZrh5EHPmmhZN0ZF7kK%2bOwIchPliyZAn7x6VYIj%2bP3WnxxpbqHQjURzH/it3Y1ZWHzVu3iHsmP/wwktNSkFqej3R9Idvdms0CtXt5CIwua1ZwMUQaX1QVaUtjqwf2IQFEDhjqkv2OavzoyHlf9J11ZfhuB1auWvP9EGDP/fItfNGexq5o5qC2wElaVblrMLg6iuJ7J1NeKkGgt98PwoZewLLKjmBZo1xaoNk3%2bkGTHEFl4aH8vUGle2wftAdYm8Y%2bU2l8Q7roR3nARyJLeSCJ7dgWyhTR21FRFMsutaaykb%2blse5ziw1njs6G9qjHroCq6Mshp6K4S0tLa6JYWlsJk%2belsMg0BYtMjGWb92xnO8J3Ql5fYHTP3Ajv7C20tF471ti4xn/8QGd/DObjRlzxp25PZhzsmM%2bki74Svv2LETc/MuDLhQZc8jZKn7kZBju80JA3J/vnl5unUOLrXVwVyV3asFC73xig32dY3qQwfNSqMmxoPzS6uTPTsPVCzohfcRhcEv4Mt8RPVo%2bRV5rIU1l8sCJQNbAxVwI1rvnzjnB4hJoi4wVfsAteprb4C2qPPydcDcTNBq/O9t9Y/URWp3xhMWX/pXUx4M1NSEMsd3MsJcux%2bDQ1PHVRWNQQDc%2bM0H4X5ccu/D00tvVI3yA8z0sdahV4YveDE2BIVAIfO7MYu3B3MXhDRCIY6PjWcJdvM9kcQhghkM7/J7uyYAq/fr12%2b%2bRgfcTvyQveJw9wpzAIIruKsJGwkxBD3pG2sGJfjkfahtf5PfPS1tvNS1on3u2mWmvlmbLe6oF/7uUB2duErQR3wnTCo//qnqpyX5v/7Xvck9eNdXWc/P/l578AjufF27Pdj9IAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="120" data-src="/assets/static/logo.1539b60.bd727e13501e82a0ba322b4ad29fd33a.png" data-srcset="/assets/static/logo.1539b60.bd727e13501e82a0ba322b4ad29fd33a.png 120w" data-sizes="(max-width: 120px) 100vw, 120px" class="text-ui-primary g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/logo.1539b60.bd727e13501e82a0ba322b4ad29fd33a.png" class="text-ui-primary g-image g-image--loaded" width="120"></noscript></a></div><div class="w-full px-2 sm:px-4 max-w-screen-xs"><!----></div><div class="flex items-center justify-end px-2 sm:px-4"><!----><!----><!----><div class=".clearfix" style="width:280px;"><a href="https://github.com/msa-ez/platform?tab=readme-ov-file#running-on-docker-compose-with-github" target="_blank" style="display:block; width:50px; height:50px; line-height:50px; float:left; padding-top: 13px;"><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" style="margin:0 auto;"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><div style="width:55px; height:50px; text-align:center; line-height:50px; font-weight:700; float:left;"><a style="cursor:pointer;">한국어</a></div><div style="width:50px; height:50px; text-align:center; line-height:50px; float:left; padding-top: 5px;"><button aria-label="Toggle Darkmode" title="Toggle Darkmode"><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div><div style="margin-left: -15px; width:130px; height:50px; text-align:center; line-height:50px; float:left;"><a href="http://labs.msaez.io/" target="_blank" rel="noopener" class="px-4 py-2 ml-auto font-bold leading-none text-white rounded-lg shadow-lg bg-ui-primary">
              실습하기
            </a></div></div></div></div></div></div></header><main class="container relative flex flex-wrap justify-start flex-1 w-full bg-ui-background"><!----><div class="w-full pb-24"><div class="flex flex-wrap items-start justify-start"><div class="order-2 lg:w-1/4 sm:w-full md:w-1/3 sm:pl-4 md:pl-6 lg:pl-8 sticky" style="top:4rem;"><div class="mt-8 sm:pl-4 md:pl-6 md:pt-12 lg:pl-8 sm:pb-16 sm:border-l border-ui-border md:mt-0"><h3 class="pt-0 mt-0 text-sm tracking-wide uppercase border-none">On this page</h3><div><ul><li class="depth-3"><a href="/development/choreography-saga/#이벤트스토밍-모델-준비" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          이벤트스토밍 모델 준비
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#orchestration-saga-시나리오" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Orchestration Saga 시나리오
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#saga-modeling" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Saga Modeling
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#process-orchestration" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Process Orchestration
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#오케스트레이션-saga-모델링-결과는-다음과-같이-보여진다" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          오케스트레이션 Saga 모델링 결과는 다음과 같이 보여진다.
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#code-생성-및-내-git-리파지토리에-푸쉬" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Code 생성 및 내 Git 리파지토리에 푸쉬
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#axon-server-확인" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Axon Server 확인
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#infra--docker-composeyml" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          infra &gt; docker-compose.yml
        </a></li><li class="border-t border-dashed border-ui-border pt-2 mt-2 font-semibold depth-2"><a href="/development/choreography-saga/#orchestration-saga-code-completion" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Orchestration Saga Code Completion
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#product-service" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Product Service
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#order-service" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Order Service
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#delivery-service" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          Delivery Service
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#ordersaga" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          OrderSaga
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#1-saga-start" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          1. Saga Start
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#2-배송시작-command-생성-및-호출--27라인" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          2. 배송시작 Command 생성 및 호출 : 27라인
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#3-deliverystartedevent-이벤트로부터-correlation-key-설정" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          3. DeliveryStartedEvent 이벤트로부터 Correlation key 설정
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#4-재고차감-command-생성-및-호출" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          4. 재고차감 Command 생성 및 호출
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#5-stockdecreasedevent-이벤트로부터-correlation-key-설정" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          5. StockDecreasedEvent 이벤트로부터 Correlation key 설정
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#6-주문완료-command-생성-및-호출" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          6. 주문완료 Command 생성 및 호출
        </a></li><li class="depth-4"><a href="/development/choreography-saga/#7-saga-end" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-3"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          7. Saga End
        </a></li><li class="border-t border-dashed border-ui-border pt-2 mt-2 font-semibold depth-2"><a href="/development/choreography-saga/#12st-mall-테스트" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          12st Mall 테스트
        </a></li><li class="border-t border-dashed border-ui-border pt-2 mt-2 font-semibold depth-2"><a href="/development/choreography-saga/#12st-mall-saga-compensation-검증" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          12st Mall Saga Compensation 검증
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#주문-생성" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
          주문 생성
        </a></li><li class="depth-3"><a href="/development/choreography-saga/#확장-미션---주문서비스-debugging" class="relative flex items-center py-1 text-sm transition transform hover:translate-x-1 pl-2"><span class="absolute w-2 h-2 -ml-3 rounded-full opacity-0 bg-ui-primary transition transform scale-0 origin-center"></span>
           - 주문서비스 Debugging
        </a></li></ul></div></div></div><div class="order-1 lg:w-3/4 sm:w-full md:w-2/3"><div class="content"><h1 id="choreography-saga"><a href="#choreography-saga" aria-hidden="true"><span class="icon icon-link"></span></a>Choreography Saga</h1>
<p>Event Sourcing, Domain driven Development 개발 및 CQRS를 지원하는 전문 Framework 중 하나인 Axon을 활용하여 Event driven한 12st Mall 을 구현하는 과정을 실습힌다. 특히, Domain 이벤트에 따라 커맨드를 Orchestration하는 프레임워크 레벨의 코드를 학습한다.</p>
<h3 id="이벤트스토밍-모델-준비"><a href="#%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%8A%A4%ED%86%A0%EB%B0%8D-%EB%AA%A8%EB%8D%B8-%EC%A4%80%EB%B9%84" aria-hidden="true"><span class="icon icon-link"></span></a>이벤트스토밍 모델 준비</h3>
<ul>
<li>아래 모델을 새 탭에서 로딩한다.
<a href="https://www.msaez.io/#/storming/axon-mallorchestrationsaga:v1.5" target="_blank" rel="noopener noreferrer">모델 링크 : https://www.msaez.io/#/storming/axon-mallorchestrationsaga:v1.5</a></li>
<li>브라우져에 모델이 로딩되지 않으면, 우측 상단의 (사람모양) 아바타 아이콘을 클릭하여 <strong>반드시</strong> 깃헙(Github) 계정으로 로그인 후, 리로드 한다.</li>
<li>로딩된 모델은 우측 팔레트 영역에 스티커 목록이 나타나지 않는다. 상단 메뉴영역에서 포크 아이콘(FORK)을 클릭해 주어진 모델을 복제한다. </li>
<li>우측 팔레트 영역에 스티커 목록들이 나타나는 것이 확인된다.</li>
</ul>
<h3 id="orchestration-saga-시나리오"><a href="#orchestration-saga-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4" aria-hidden="true"><span class="icon icon-link"></span></a>Orchestration Saga 시나리오</h3>
<ul>
<li>주문 커맨드에 따라 OrderPlaced 이벤트가 생성된다.</li>
<li>OrderPlaced 이벤트로 Order Saga 프로세스가 구동된다.</li>
<li>Saga Process는 배송시작 커맨드를 호출하고 DeliveryStarted 이벤트를 생성한다.</li>
<li>이어, 재고차감 커맨드가 호출되고 StockDecreased 이벤트를 생성한다.</li>
<li>최종 주문상태를 업데이트하는 절차로 Saga Process는 종료된다.</li>
<li>각 커맨드 호출시, 오류가 발생하면 이의 처리를 위해 Compensation Logic이 각각 실행된다. </li>
</ul>
<h3 id="saga-modeling"><a href="#saga-modeling" aria-hidden="true"><span class="icon icon-link"></span></a>Saga Modeling</h3>
<ul>
<li>모델 상단의 Fork 메뉴를 클릭한다.</li>
<li>복제돤 모델을 다음과 같이 오케스트레이션 한다.</li>
</ul>
<h3 id="process-orchestration"><a href="#process-orchestration" aria-hidden="true"><span class="icon icon-link"></span></a>Process Orchestration</h3>
<p>오케스트레이션 Saga 모델링 규칙은 다음과 같다.</p>
<blockquote>
<ol>
<li>스티커를 선으로 연결한다. 'From Sticker' > 'To Sticker'</li>
<li>매핑 릴레이션을 클릭하여, 레이블을 부여한다. 레이블은 실행 순서를 의미</li>
<li>레이블 중, '가 붙은 프로세스는 보상처리(Compensation Trx) 프로세스 임 </li>
</ol>
<ul>
<li>OrderPlaced > Order Saga, (1.start)</li>
<li>Order Saga > start delivery, (2)</li>
<li>DeliveryStarted > Order Saga, (3)</li>
<li>Order Saga > decrease stock, (4)</li>
<li>StockDecreased > Order Saga, (5)</li>
<li>Order Saga > update status, (6)</li>
<li>OrderCompleted > Order Saga, (7.end)</li>
<li>Order Saga > order cancel, (2')</li>
<li>Order Saga > cancel delivery, (4')</li>
</ul>
</blockquote>
<h4 id="오케스트레이션-saga-모델링-결과는-다음과-같이-보여진다"><a href="#%EC%98%A4%EC%BC%80%EC%8A%A4%ED%8A%B8%EB%A0%88%EC%9D%B4%EC%85%98-saga-%EB%AA%A8%EB%8D%B8%EB%A7%81-%EA%B2%B0%EA%B3%BC%EB%8A%94-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EC%9D%B4-%EB%B3%B4%EC%97%AC%EC%A7%84%EB%8B%A4" aria-hidden="true"><span class="icon icon-link"></span></a>오케스트레이션 Saga 모델링 결과는 다음과 같이 보여진다.</h4>
<p><img src="https://user-images.githubusercontent.com/35618409/229645326-3a24d5e3-81f3-4ecb-9e6f-2101302eb697.png" alt="image"></p>
<h3 id="code-생성-및-내-git-리파지토리에-푸쉬"><a href="#code-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EB%82%B4-git-%EB%A6%AC%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC%EC%97%90-%ED%91%B8%EC%89%AC" aria-hidden="true"><span class="icon icon-link"></span></a>Code 생성 및 내 Git 리파지토리에 푸쉬</h3>
<ul>
<li>Code Preview > Git 아이콘을 눌러 내 레파지토리에 푸쉬한다.
<img src="https://user-images.githubusercontent.com/35618409/229663138-ec1a8a2c-a50f-4c3c-ba4c-75c1ea9057ad.png" alt="image"></li>
</ul>
<p><img src="https://user-images.githubusercontent.com/35618409/229649084-15d388b9-3246-43b2-956c-d1012f47ce12.png" alt="image"></p>
<ul>
<li>GitPod 환경에서 로딩한다.
<img src="https://user-images.githubusercontent.com/35618409/229649200-cd48e7fb-54bb-46af-9806-0f893d9375bb.png" alt="image"></li>
</ul>
<h3 id="axon-server-확인"><a href="#axon-server-%ED%99%95%EC%9D%B8" aria-hidden="true"><span class="icon icon-link"></span></a>Axon Server 확인</h3>
<h4 id="infra--docker-composeyml"><a href="#infra--docker-composeyml" aria-hidden="true"><span class="icon icon-link"></span></a>infra > docker-compose.yml</h4>
<ul>
<li>Axon Server는 대시보드를 위한 8024, 메시지 gRPC를 위한 8124 포트를 사용한다.</li>
<li>각 서비스들의 Offset Token 관리를 위한 Token Store(MySQL)가 Lab 실행시 생성된다.</li>
</ul>
<h2 id="orchestration-saga-code-completion"><a href="#orchestration-saga-code-completion" aria-hidden="true"><span class="icon icon-link"></span></a>Orchestration Saga Code Completion</h2>
<h3 id="product-service"><a href="#product-service" aria-hidden="true"><span class="icon icon-link"></span></a>Product Service</h3>
<p>상품 Domain 코드에 Biz 로직을 완성한다.</p>
<ul>
<li>재고 부족시 도메인 오류 발생코드를 추가한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># ProductAggregate - @DecreaseStockCommand 재고부족시 Exception 발생 
	if(this.getStock() &lt; command.getStock()) throw new IllegalStateException(&quot;Out of Stock. !&quot;);  // 코드추가</code></pre>
<ul>
<li>product > ProductAggregate.java 내 다음 코드를 추가한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># @EventSourcingHandler :: StockIncreasedEvent : 
    setStock(getStock() + event.getStock());  // 코드추가

#  @EventSourcingHandler :: StockDecreasedEvent : 
    setStock(getStock() - event.getStock());  // 코드추가</code></pre>
<h3 id="order-service"><a href="#order-service" aria-hidden="true"><span class="icon icon-link"></span></a>Order Service</h3>
<p>주문 Domain 코드에 Biz 로직을 완성한다.</p>
<ul>
<li>order > OrderAggregate.java 내 다음 코드를 추가한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># @EventSourcingHandler :: OrderPlacedEvent :
     setStatus(&quot;OrderPlaced&quot;); 			// 코드추가
# @EventSourcingHandler :: OrderCompletedEvent : 
     setStatus(&quot;OrderCompleted&quot;); 		// 코드추가
# @EventSourcingHandler :: OrderCancelledEvent :      
      setStatus(&quot;OrderCancelled&quot;);		// 코드추가</code></pre>
<h3 id="delivery-service"><a href="#delivery-service" aria-hidden="true"><span class="icon icon-link"></span></a>Delivery Service</h3>
<p>배송 Domain 코드에 Biz 로직을 완성한다.</p>
<ul>
<li>delivery > DeliveryAggregate.java 내 다음 코드를 추가한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># @EventSourcingHandler :: DeliveryStartedEvent :
      setStatus(&quot;DeliveryStarted&quot;); 		// 코드추가
# @EventSourcingHandler :: DeliveryCancelledEvent : 
      setStatus(&quot;DeliveryCancelled&quot;); 		// 코드추가</code></pre>
<h3 id="ordersaga"><a href="#ordersaga" aria-hidden="true"><span class="icon icon-link"></span></a>OrderSaga</h3>
<p>주문 오케스트레이션을 수행하도록 OrderSaga 코드를 완성한다.</p>
<h4 id="1-saga-start"><a href="#1-saga-start" aria-hidden="true"><span class="icon icon-link"></span></a>1. Saga Start</h4>
<ul>
<li>OrderPlaced 이벤트로부터 Correlation key 설정 : 24 라인</li>
</ul>
<pre class="language-text"><code class="language-text">	@SagaEventHandler(associationProperty = &quot;orderId&quot;)</code></pre>
<h4 id="2-배송시작-command-생성-및-호출--27라인"><a href="#2-%EB%B0%B0%EC%86%A1%EC%8B%9C%EC%9E%91-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C--27%EB%9D%BC%EC%9D%B8" aria-hidden="true"><span class="icon icon-link"></span></a>2. 배송시작 Command 생성 및 호출 : 27라인</h4>
<pre class="language-text"><code class="language-text">command.setOrderId(event.getOrderId());
command.setProductId(event.getProductId());
command.setQty(event.getQty());
command.setUserId(event.getUserId());

# 배송실패시, 주문취소 Compensation 처리 : OrderCancelCommand
orderCancelCommand.setOrderId(event.getOrderId());  	// 코드추가</code></pre>
<h4 id="3-deliverystartedevent-이벤트로부터-correlation-key-설정"><a href="#3-deliverystartedevent-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A1%9C%EB%B6%80%ED%84%B0-correlation-key-%EC%84%A4%EC%A0%95" aria-hidden="true"><span class="icon icon-link"></span></a>3. DeliveryStartedEvent 이벤트로부터 Correlation key 설정</h4>
<pre class="language-text"><code class="language-text">	@SagaEventHandler(associationProperty = &quot;orderId&quot;)</code></pre>
<h4 id="4-재고차감-command-생성-및-호출"><a href="#4-%EC%9E%AC%EA%B3%A0%EC%B0%A8%EA%B0%90-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C" aria-hidden="true"><span class="icon icon-link"></span></a>4. 재고차감 Command 생성 및 호출</h4>
<pre class="language-text"><code class="language-text">command.setProductId(event.getProductId());
command.setStock(event.getQty());	
command.setOrderId(event.getOrderId());

# 재고차감 실패시, 배송취소 Compensation 처리 : CancelDeliveryCommand
cancelDeliveryCommand.setDeliveryId(event.getDeliveryId());	// 코드추가</code></pre>
<h4 id="5-stockdecreasedevent-이벤트로부터-correlation-key-설정"><a href="#5-stockdecreasedevent-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A1%9C%EB%B6%80%ED%84%B0-correlation-key-%EC%84%A4%EC%A0%95" aria-hidden="true"><span class="icon icon-link"></span></a>5. StockDecreasedEvent 이벤트로부터 Correlation key 설정</h4>
<pre class="language-text"><code class="language-text">	@SagaEventHandler(associationProperty = &quot;orderId&quot;)</code></pre>
<h4 id="6-주문완료-command-생성-및-호출"><a href="#6-%EC%A3%BC%EB%AC%B8%EC%99%84%EB%A3%8C-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C" aria-hidden="true"><span class="icon icon-link"></span></a>6. 주문완료 Command 생성 및 호출</h4>
<pre class="language-text"><code class="language-text">command.setOrderId(event.getOrderId());</code></pre>
<h4 id="7-saga-end"><a href="#7-saga-end" aria-hidden="true"><span class="icon icon-link"></span></a>7. Saga End</h4>
<ul>
<li>OrderCompletedEvent 이벤트로부터 Correlation key 설정</li>
</ul>
<pre class="language-text"><code class="language-text">	@SagaEventHandler(associationProperty = &quot;orderId&quot;)</code></pre>
<ul>
<li>Saga Process 종료</li>
</ul>
<h2 id="12st-mall-테스트"><a href="#12st-mall-%ED%85%8C%EC%8A%A4%ED%8A%B8" aria-hidden="true"><span class="icon icon-link"></span></a>12st Mall 테스트</h2>
<ul>
<li>Rest API를 활용해 생성된 Axon Saga 기반 몰을 테스트 한다.</li>
<li>먼저 Common API를 빌드한다.</li>
</ul>
<pre class="language-text"><code class="language-text">cd common-api
mvn clean install</code></pre>
<ul>
<li>각 마이크로 서비스를 실행한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># new terminal
cd order
mvn clean spring-boot:run

# new terminal
cd product
mvn clean spring-boot:run

# new terminal
cd delivery
mvn clean spring-boot:run</code></pre>
<ul>
<li>상품서비스(:8082)에 테스트용 상품을 등록한다.</li>
</ul>
<pre class="language-text"><code class="language-text"># new terminal
http POST :8082/products productName=TV stock=100</code></pre>
<ul>
<li>등록된 상품 Id를 복사해 둔다.
<img src="https://user-images.githubusercontent.com/35618409/229345799-6a86743c-d3b1-43b7-9a94-91c4e50cfd9b.png" alt="image"></li>
<li>복사한 상품 Id로 10개의 TV를 구매하는 주문을 생성한다.</li>
</ul>
<pre class="language-text"><code class="language-text">http POST :8081/orders productId=[상품 Id] productName=TV qty=10 userId=1001</code></pre>
<ul>
<li>생성된 주문 Id를 복사해 둔다.
<img src="https://user-images.githubusercontent.com/35618409/229346264-89d2c227-5dc8-454d-acb0-1c24bc0da63d.png" alt="image"></li>
</ul>
<h2 id="12st-mall-saga-compensation-검증"><a href="#12st-mall-saga-compensation-%EA%B2%80%EC%A6%9D" aria-hidden="true"><span class="icon icon-link"></span></a>12st Mall Saga Compensation 검증</h2>
<h3 id="주문-생성"><a href="#%EC%A3%BC%EB%AC%B8-%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="icon icon-link"></span></a>주문 생성</h3>
<ul>
<li>상품 Id로 100개의 TV를 구매하는 주문을 생성하고 주문번호를 복사해 두자.</li>
</ul>
<pre class="language-text"><code class="language-text">http POST :8081/orders productId=[상품 Id] productName=TV qty=100 userId=1001</code></pre>
<ul>
<li>재고 개수(90)보다 많은 주문으로 상품서비스에서 오류를 리턴한다.</li>
</ul>
<ul>
<li>주문 번호로 생성된 주문의 최종 상태와 이벤트 이력을 조회해 본다.</li>
</ul>
<pre class="language-text"><code class="language-text">http GET :8081/orders/[주문번호]
http GET :8081/orders/[주문번호]/events</code></pre>
<ul>
<li>배송서비스의 배송 상태를 조회해 본다.</li>
</ul>
<pre class="language-text"><code class="language-text">http GET :8083/deliveries</code></pre>
<h3 id="확장-미션---주문서비스-debugging"><a href="#%ED%99%95%EC%9E%A5-%EB%AF%B8%EC%85%98---%EC%A3%BC%EB%AC%B8%EC%84%9C%EB%B9%84%EC%8A%A4-debugging" aria-hidden="true"><span class="icon icon-link"></span></a>[확장 미션] - 주문서비스 Debugging</h3>
<ul>
<li>주문서비스를 종료한다.</li>
<li>OrderSaga 에 SagaEventHandler별로 Break Points를 추가한다.</li>
<li>주문서비스를 디버그 모드로 실행한다.</li>
<li>새로운 주문을 생성한 다음 Debug Point를 확인하면서 Orchestration 흐름을 식별한다.</li>
<li>재고보다 많은 수량을 넣어 Debug Point를 확인한다.</li>
</ul>
</div><div class="mt-8 pt-8 lg:mt-12 lg:pt-12 border-t border-ui-border"><div><div class="flex flex-col sm:flex-row justify-between items-center"><!----><!----></div></div></div></div></div></div></main></div><!----><div data-v-792b27e8><div style="width:100%; padding-bottom:30px; background-color:#1E88E5;" data-v-792b27e8><div class="flex logo-style" data-v-792b27e8><div data-v-792b27e8><img src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 331 174' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-37afcb0017f229c304bfe602273e7d7c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-37afcb0017f229c304bfe602273e7d7c)' width='331' height='174' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAYAAADvVd%2bPAAAACXBIWXMAAC4jAAAuIwF4pT92AAATu0lEQVRo3sVZB3RU15lWIxhscMtunHhd8EkcJzFusb1xwMaAuoQkpFEFUWQwzXEMAQSYElFEkVCbGUmjikZdIJBAqIxmRgUJVRAqmGLABQdwTBDqZebdb/97Z0YIO1nvnrN7mHO%2b89/35pX5vvu3e8fKij69eQ4C48ffg7UZNgK5DrY9ufZ2wtJ5qwfw0cirrDSKahuCrRk0rrKuUFRb05h/Z1VhukZcP378g09vnr2VmZwtR4/Z8nNE9Ed/DAlhRfdM%2bS7X/QXkv/rWtrQ6R2cVW%2bSVNBDkoRoK9EwaCvBMGvQn60fwJcgIPnRuvkfSkBeNPWns4aEadCfrRseudN5lvmrAZU6SZJ%2bobA/Ry3XLyhXV7xPBXxGRh/%2b731PxQ3FsK%2bTi2Fojrx4TQtievP8BQSJHBJ8h%2bzrBje5ZQTaMhEulcTmN2%2bn7G925zgNS/n9K0enF3S5qwC8T8LFAfT9kZojjDMDbgkP34ENwIySnXkNraiN0CfUgAQbph39DaCQyeWT3EuHlhDk0/hXZx36MDxdovOUEnyC8SiQcyS4mbOnNtY8nW0K2lfAFobc/3wGGo05AsTNwwpXgBlbsIs4NHXZEb74zjPnvQJ2ROmKvgmF%2bUr%2bBZpQwZKDZFdaLjt0T%2bgyO8l6jo7zP6KzoNXok9hvpvJG8xUjXE8iqBgXck4alQ8ozxiq5zkAeIFUqa6BPqENNUiPqU1twOu0M6lKaUa06DRJghEhdJ9tMOMzFISwjOBB%2bTZh6T4Tq%2b1w4khU5Y6DAETjuQsRcTJbIGY%2b5YOiIM/oLnECCMAoJqTfP0XA3Z67hTsYfCTMMPbkORvpO6s51Yoa8P7JydTgcVWBeSf2MCDEiT3aI7ACzVwyyoBywtSVg60%2bCfXQcbH46mKNigK7n1wyJe4g8m0fH3nTPYUUj08n1jGafaUyQiKiRrIGsoeSgxngiUiOVx%2bpRlViPWhKHi3I6tZVEahXnuDiEvxHOE%2baYQ8DGIsBfOGma5REiQoTsDdxyknfVfzT2Z8%2bQutUzGHkI4yLczX6fjRx1ZWjczFC3FgN5c0iYuexunhNG8mayM1l/Zm4qIycCQSZpCB6JA5iXNIq4GiNi0ouxdsNWfLx2Azbt2IeUomZsLQOclIMgTwCJABIANPsIVPWgRFGLSnkVd39OBERaCFEep4dGXsM6T1xkFzRXWP2hFlYarZPoOyMXhgtEiZFbqVJRA62yFo3pbXR/tbNZAFshAM2gB3djImck8pwkiDyjmWcjDXvw93oFjLXr0Zv9Pj%2bPkWIvdGiS4ecfiDVr/oRvT8WiP3c2unMd2WDeLFzNCWZ%2bSXfZPNUwF0CQcoofRkLNABb6eYJeeR9%2bYm2FvZFyfFQEOCv76XqTAK5JI1iWeJtIVnHS4wWgcRU0cdVo03ZgzUdr4ObuhqK8YjTlnEVptNbiKXQvt0IwSdwrckjVS9/zAPtX%2b4h0r2WGcx2I0CzcOhUHV68ATHniKWzf8VdIdZvxj5RXITXtwRyne0T2hG0FqpbhH%2br30Jdnj9u57vgg%2bSu4qIxEZgDOij6sJnI790aZ77HGc88/D4c5s/DitKfFueAAH%2bypAubG9QnBvEgAZ/KYtYk3QBVAkK8wk9coq3EiogIXyj/Hnz7%2b09jvePq5X%2bBM5TlUxJgEEteaReMC8NxB9ibhSbMA1pYk%2bBTh9iDlAB7Ld7LeB8p9kZW4995M2U5GV2UyjHnv4FZNFJ5%2b/sWx75xc3IGG7ejOeAc9FAaDebOxPvUcnFQM3skDsCdSYVrAV%2bYtrqe3Iv%2b4Hse%2bBGLKbmK3IhcJFX%2bDd6oB81Q8bIaEAE4kwLaEL1Aj16LcLAAnw12/WtUA/YkqTJg4QQg6wW6CePaRjKOoS21GWaxuPHnuAcYauodE6Rgrg5ZEaK77nZYwuJNJAlQEID0uTDx00kMThd26eQNQvxJtxfsxYfLj45R/EX%2bvjUZ/9kx05zljNG8mDqSVw0FF5SypHw7yPoRSjK9eY5otG1tbTJ/%2bCjaHxyO%2b/BtENwMOCRLcE/oFeUqaYx5wIP7iPQHGzf4l3VX4%2bvmanmdjAzs7O7M3huNsQSdORlWOCVAhNwlwKrmJH580l0BrSx9gY06EpbwSmAVgqAhEauxO8VA7O1thX3jpFaArGcXJ2%2bnYZlwc/wS1R6IgFbngdraj8JJDhw5hLglApVAkQK9UBrXmMn75H0/cF///9thD%2bGjVCiTV9sFNNUKxPyBEsOQAaoJQZRaAk%2bEzW5/WguL847CyNj3DP8Afb775phgHBgbifNlllERqxvKFWQgDrwpklUIARZWtEIB3fOYwUPLSx7P/ncxZgCYIqqi/iodOmGAnwMe1ZflIVR4Q45df/h0ef/wxMY4O/xTQLsJ3mbNFL1Cq3sdLIcWzKam5xvcjOJshobgD/rL5eOZnj90nxKrlS7GbwsRe3i9yABeAyiCylS0iB5TLq8Xsl0RocKn6Khwc7cV9EydOxMWOi/Dy9BLHr73xKs5VdKIsalwIiKpRZeA9Ax1vMMe/ncUDzALYrxWl0CQAQ%2bVCKCO2i4c%2b9dTP4OnhIcZLQ5ZhY2ioGIeGbsK7774rxgEBgZQHNuN2xkyM5L%2bHlqy1cFeNjlUB14RBEgDYcwpQtALyir9jx/54/PQJUyg9%2begkJJR9SbNOiVM1IMjLVP04qjgNrVwv4v9kdCWas9qQmZo1JpyrmytGuw1YtWKVOJ7y6BToi2qgU9bR7OvHl00j7w/oOf7fL4G25hDwko5ZQoALEIy4/dtMbvrTJ3HsWLGItUcfnYpp06aJ88XHCvHh8uVi/NL036O7LhI9WTOpL5iNKzmLIEvqhQfVcj77Kw8DyowiBPnLsDu%2bENHlt1F%2b5hZeefm34v5HH54A5YmLmJfCSIB%2bCodhLErsRin1ABpz7Jce1OJCzWW88ebrYwLYUfKbNu15PPPsM2PnUpSpaFJTOYzRmgQwlUGmja/lx3%2bwlECzBzjYmEPgDXMZxJ3M9xh35%2bjwreKBDz00Cd9c6YCri5M56ViLHHCp/ggU%2b03XTJryBGs7GQdDoT3rz7dnd3Jd2AfJX1MzY2C8tMnrgHffnm66n/D8009i6iOTxn60y5wZiKk2Yq58kHknk8ckG9kq1W1mnn1WElXJ2g6fR1yU3PQMaxtMpOQ8cfLEsWfY2ppy1bpP1qG96AKoQxyrAryF1pjWEc9YSqBoh3vNy1kS4t8pHLoHqKcnASRol7DI3Z9ayOFWSzYKUvaPvWzi1J%2bhpzUJukyRKBlHbPgmSOXB0lfy6axAsYknM9ENcg9YXgCosk7gtd88B7txsT/RlsjPnQl15efwPcTYvERqiVW8ctyR1sZclKoVep4AWUVsFdprOjHtxWlj9xYVFAt3z07JwY6tOzB58mRTWXZ2wnmNSIRi5ikEJF0CD4mqL%2bj4ke/3AJZ22I7GF0YKnXFH/a4E/VIWtuUT88sm4sLJfRhqjMCiZWvw%2b7dnQBF7EJJ%2bNb6sjMD7rv7s3VmzkZGWIn2e4YfCXZ6QJXZL85JHqAz2Md4LuJAIHx6h2NcPIiK7CfsT8nFAVYD4oy2IqzVAdshIOWOAucXdwtwdTdI721vx6f561MRXSWWiqalmLaVtKMopRtS%2baCTGJ6L95GfQxp0S/f71MzcoDF8Sv3fq41PRUNLMKuNqxMxTCzzK1wZE%2bizn2nTo3L29Ab7eH/OCXIdyvrojDzCgcjGRjMKvf/caZEEhuF4bj%2bH8WaIbNDbuAXTL0JM5A/0ngjHaEoEbpaHSxewQtOz%2bzTerFU2pjqnU28cbpbnxYPbxIHIGeCTcxaK0r7D%2byDdYkAsEZQGeKcCcGAluSgN5DHWCu65Is7e04q3QlvbMyLq6hsRGEBGpMo5qeUw1TiU3oyW7HWfyO6gk6kWio4UQTqkboSmqRPS%2bGGzaFMpOVzSxshgdjkeVGYoiS8V1ZHdxnof3FtmMXwqLRsg8TuCVQCyG8p1Yb00Yhhv2AY3bMXDMB3ezqd9Xz8DdjD9wkajrcyQRZqEn/Q%2bs/q/TUfHpa7i2Y/J7ATmG5esKv8POww2G5JJjrESbgDP12/F162o20uWDr5rWMO%2b0a8yn8DjzP6JBwJEa5lvQAN%2b8s8w9vgLOUSfhrM5aWnjo%2bMky9SkUJdJqL0HLSuN1KJPrGFUDgXEZHnwlSJ0ea8lpZ53FF3E0%2bgSTr08YTd2WAcWGxMHotfLFltnftTL8BxsetuY8sMHSC4hFURatANXvsDu8xc2ZLdYJRJrgxFeGUm%2bBg9RX7MJ6S93ZdfKcm1r324aLvvqecwu6Bzr8YOhwZaxjDkPnbOAzdxjPe8Jw3oN1t4Vg5dFTWFC9E0uqd7HF1buwuHo3FmjD2ELdHgTrw43Bur1scdVBLNVFsg%2b0B7FCE81Wl8fiz6UKdlRVYdDKawyU3fmqT7q3OtQxnvmPR5Qb4zcmSenbMxEfmtSYuDnlRc6vOaPdOnz1/vs3Q3pMe34WD5hvpFJI5EfFyjDPicPA1/9mUfi6H/0FDhjimyM6dwx/JmPD52Ug4ky67A9c8QEuuAGfyxi%2bDgFuUvt8YyOGaeYHO2VsiOxohz/bUZrd76eNYot1kQjWRrIg3QGsaVVhdUsiW96oQMjpWCyoiWB%2bleEkyAG2UH8AgVX72BJ9JDTqOjSmnEVtciP0CfWoVIryxpOdQRd/auRY5EmoNqciYVNypGWSlRtVdiSGZXzfbpDYD7SUwkGqAhyjtC7grTHfFLFskBiPibUCx0BPtv3XfSddLnHyQ50%2bBBkG2z0Zu7bG2H01RTpTk4Dighi2J2wD2xW2DX1XDmCkcx4b6PQDzntJmQ1/OS/TRklLiViQbj%2bLbi6APCuZRWUmQHE4nSmLM5i6rpjtbctDYCV5gz6SPCUSIdqDdwuTyg9o42oyyANqiTjP7AN8rc/zQ2P6WaRtU9%2bKWadws5An4rYW4hYRvh8C1mb7C8JNwrdUEtvJaqk6ZJDdTZ7C9wE9qGN8m1z/%2bW8/fMVu6Jz3NCI/NEoiDLR7M1wJRIM%2bFT9/5mXKxrb3St0jv8D1LjWkC57o7/BlJADyGz8xkAAsuHIvVjQpWUZR3n2t8aQJEzHJegKiE%2bVY15aKQE24tLQumnvD1fv29xRVD5EAz9KMzqCMv6AkWrOZZv9Z/l3iphRbImxtFsGKPOKfbxJaNkaJHN8ZfpaOn6Txj253D1/yfWi4S3YFl/3Q1%2bYp4cYKpCbsFgR%2b%2b9uXUHQkFV2tJzB6tw34ZiMGzrmxwS7hAexQw3r4aKNAHsACdfsQ1VoAZX4aEnLTsHLlyjEhFNkpWNOSiCDNXuPS%2bhgs0kV05aaW2DUcbLQ5mJfzL3%2bjZdZ/lPz4rfF/5hm8U%2bTrBfresl1u03vUyXqg1kOEDQmgwxcB3AOMuBbIasqU4oe//tprqNEeQUzEpwhe4IfTmjjgajDr455yfj7i60MZCUAxfQCL9BHMXxOO1W0q6L48g7feMK3swnaGIfryccjKKUnqI408LwTrIk7z966siLVWqQutzP8BUFdXZVOpqLE9GVNpm/xpuhAmb0/hjxO/rxka/ydI7g//IOkR5%2bytyO05caEwxb4KXwVisENmYBe92NWzKkx%2b5Kc/2PZKT9oPXF%2bBvnNeYF3z2cG6LYxCAEIASoABur3Iv6DHrHdmiuuXLQlB2tVK%2bFRw8hFE/IAxpCGOi1XO30vWms5ZBBC/nxKgFVUBq5xdBeK4cP/x/59/ZYY7ZWMCkP2ECzDU6WsY6XRF3zUFXvilqedXxh3A9YslGL7TAgwVstHz89kgJUzpMx8WXreN%2bVJ5W0qzL9PshvqaDouCFor7fLy8UXyjCX41%2b3gCFB5CZA0fNMZxIXL5e8nacAEeyIdI3xOgU%2baKq/4Y6vI1Dp5zZrh5EHPmmhZN0ZF7kK%2bOwIchPliyZAn7x6VYIj%2bP3WnxxpbqHQjURzH/it3Y1ZWHzVu3iHsmP/wwktNSkFqej3R9Idvdms0CtXt5CIwua1ZwMUQaX1QVaUtjqwf2IQFEDhjqkv2OavzoyHlf9J11ZfhuB1auWvP9EGDP/fItfNGexq5o5qC2wElaVblrMLg6iuJ7J1NeKkGgt98PwoZewLLKjmBZo1xaoNk3%2bkGTHEFl4aH8vUGle2wftAdYm8Y%2bU2l8Q7roR3nARyJLeSCJ7dgWyhTR21FRFMsutaaykb%2blse5ziw1njs6G9qjHroCq6Mshp6K4S0tLa6JYWlsJk%2belsMg0BYtMjGWb92xnO8J3Ql5fYHTP3Ajv7C20tF471ti4xn/8QGd/DObjRlzxp25PZhzsmM%2bki74Svv2LETc/MuDLhQZc8jZKn7kZBju80JA3J/vnl5unUOLrXVwVyV3asFC73xig32dY3qQwfNSqMmxoPzS6uTPTsPVCzohfcRhcEv4Mt8RPVo%2bRV5rIU1l8sCJQNbAxVwI1rvnzjnB4hJoi4wVfsAteprb4C2qPPydcDcTNBq/O9t9Y/URWp3xhMWX/pXUx4M1NSEMsd3MsJcux%2bDQ1PHVRWNQQDc%2bM0H4X5ccu/D00tvVI3yA8z0sdahV4YveDE2BIVAIfO7MYu3B3MXhDRCIY6PjWcJdvM9kcQhghkM7/J7uyYAq/fr12%2b%2bRgfcTvyQveJw9wpzAIIruKsJGwkxBD3pG2sGJfjkfahtf5PfPS1tvNS1on3u2mWmvlmbLe6oF/7uUB2duErQR3wnTCo//qnqpyX5v/7Xvck9eNdXWc/P/l578AjufF27Pdj9IAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="331" data-src="/assets/static/logo.34ff00f.bd727e13501e82a0ba322b4ad29fd33a.png" data-srcset="/assets/static/logo.34ff00f.bd727e13501e82a0ba322b4ad29fd33a.png 331w" data-sizes="(max-width: 331px) 100vw, 331px" class="g-image g-image--lazy g-image--loading" data-v-792b27e8 data-v-792b27e8><noscript data-v-792b27e8 data-v-792b27e8><img src="/assets/static/logo.34ff00f.bd727e13501e82a0ba322b4ad29fd33a.png" class="g-image g-image--loaded" width="331"></noscript></div></div><div style="width:100%; text-align:center; font-size:14px; color:white; font-weight:300; line-height:1.5; padding-top:20px;" data-v-792b27e8><div data-v-792b27e8><div data-v-792b27e8><div class="footer-top-div" data-v-792b27e8>© MSA-Ez Authors 2023.  </div><div class="footer-top-div" data-v-792b27e8>© 2023 uEngine All rights reserved.</div></div><div data-v-792b27e8>
                    uEngine has registered trademarks and uses trademarks. and MSA-Ez is licensed under the GNU General Public License version 3.0.
                </div></div><div class="footer-bot" data-v-792b27e8><div data-v-792b27e8><a href="https://www.gnu.org/licenses/gpl-3.0.en.html#license-text" target="_blank" style="color:#fff;" data-v-792b27e8>
                        See LICENSE
                    </a>
                      |   
                </div><div data-v-792b27e8><a href="https://github.com/msa-ez/platform" target="_blank" style="color:#fff;" data-v-792b27e8>
                        Github Site
                    </a>
                      |   
                </div><div data-v-792b27e8>E-Mail: help@uengine.org</div></div></div></div></div></div>
    <script>window.__INITIAL_STATE__={"data":{"markdownPage":{"id":"f6cee4eb7a576512959970274e4db3b7","title":"Choreography Saga","description":"","path":"\u002Fdevelopment\u002Fchoreography-saga\u002F","timeToRead":7,"content":"\u003Ch1 id=\"choreography-saga\"\u003E\u003Ca href=\"#choreography-saga\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EChoreography Saga\u003C\u002Fh1\u003E\n\u003Cp\u003EEvent Sourcing, Domain driven Development 개발 및 CQRS를 지원하는 전문 Framework 중 하나인 Axon을 활용하여 Event driven한 12st Mall 을 구현하는 과정을 실습힌다. 특히, Domain 이벤트에 따라 커맨드를 Orchestration하는 프레임워크 레벨의 코드를 학습한다.\u003C\u002Fp\u003E\n\u003Ch3 id=\"이벤트스토밍-모델-준비\"\u003E\u003Ca href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%8A%A4%ED%86%A0%EB%B0%8D-%EB%AA%A8%EB%8D%B8-%EC%A4%80%EB%B9%84\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E이벤트스토밍 모델 준비\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E아래 모델을 새 탭에서 로딩한다.\n\u003Ca href=\"https:\u002F\u002Fwww.msaez.io\u002F#\u002Fstorming\u002Faxon-mallorchestrationsaga:v1.5\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E모델 링크 : https:\u002F\u002Fwww.msaez.io\u002F#\u002Fstorming\u002Faxon-mallorchestrationsaga:v1.5\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E브라우져에 모델이 로딩되지 않으면, 우측 상단의 (사람모양) 아바타 아이콘을 클릭하여 \u003Cstrong\u003E반드시\u003C\u002Fstrong\u003E 깃헙(Github) 계정으로 로그인 후, 리로드 한다.\u003C\u002Fli\u003E\n\u003Cli\u003E로딩된 모델은 우측 팔레트 영역에 스티커 목록이 나타나지 않는다. 상단 메뉴영역에서 포크 아이콘(FORK)을 클릭해 주어진 모델을 복제한다. \u003C\u002Fli\u003E\n\u003Cli\u003E우측 팔레트 영역에 스티커 목록들이 나타나는 것이 확인된다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"orchestration-saga-시나리오\"\u003E\u003Ca href=\"#orchestration-saga-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOrchestration Saga 시나리오\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E주문 커맨드에 따라 OrderPlaced 이벤트가 생성된다.\u003C\u002Fli\u003E\n\u003Cli\u003EOrderPlaced 이벤트로 Order Saga 프로세스가 구동된다.\u003C\u002Fli\u003E\n\u003Cli\u003ESaga Process는 배송시작 커맨드를 호출하고 DeliveryStarted 이벤트를 생성한다.\u003C\u002Fli\u003E\n\u003Cli\u003E이어, 재고차감 커맨드가 호출되고 StockDecreased 이벤트를 생성한다.\u003C\u002Fli\u003E\n\u003Cli\u003E최종 주문상태를 업데이트하는 절차로 Saga Process는 종료된다.\u003C\u002Fli\u003E\n\u003Cli\u003E각 커맨드 호출시, 오류가 발생하면 이의 처리를 위해 Compensation Logic이 각각 실행된다. \u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"saga-modeling\"\u003E\u003Ca href=\"#saga-modeling\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESaga Modeling\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E모델 상단의 Fork 메뉴를 클릭한다.\u003C\u002Fli\u003E\n\u003Cli\u003E복제돤 모델을 다음과 같이 오케스트레이션 한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"process-orchestration\"\u003E\u003Ca href=\"#process-orchestration\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EProcess Orchestration\u003C\u002Fh3\u003E\n\u003Cp\u003E오케스트레이션 Saga 모델링 규칙은 다음과 같다.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Col\u003E\n\u003Cli\u003E스티커를 선으로 연결한다. 'From Sticker' \u003E 'To Sticker'\u003C\u002Fli\u003E\n\u003Cli\u003E매핑 릴레이션을 클릭하여, 레이블을 부여한다. 레이블은 실행 순서를 의미\u003C\u002Fli\u003E\n\u003Cli\u003E레이블 중, '가 붙은 프로세스는 보상처리(Compensation Trx) 프로세스 임 \u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cul\u003E\n\u003Cli\u003EOrderPlaced \u003E Order Saga, (1.start)\u003C\u002Fli\u003E\n\u003Cli\u003EOrder Saga \u003E start delivery, (2)\u003C\u002Fli\u003E\n\u003Cli\u003EDeliveryStarted \u003E Order Saga, (3)\u003C\u002Fli\u003E\n\u003Cli\u003EOrder Saga \u003E decrease stock, (4)\u003C\u002Fli\u003E\n\u003Cli\u003EStockDecreased \u003E Order Saga, (5)\u003C\u002Fli\u003E\n\u003Cli\u003EOrder Saga \u003E update status, (6)\u003C\u002Fli\u003E\n\u003Cli\u003EOrderCompleted \u003E Order Saga, (7.end)\u003C\u002Fli\u003E\n\u003Cli\u003EOrder Saga \u003E order cancel, (2')\u003C\u002Fli\u003E\n\u003Cli\u003EOrder Saga \u003E cancel delivery, (4')\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 id=\"오케스트레이션-saga-모델링-결과는-다음과-같이-보여진다\"\u003E\u003Ca href=\"#%EC%98%A4%EC%BC%80%EC%8A%A4%ED%8A%B8%EB%A0%88%EC%9D%B4%EC%85%98-saga-%EB%AA%A8%EB%8D%B8%EB%A7%81-%EA%B2%B0%EA%B3%BC%EB%8A%94-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EC%9D%B4-%EB%B3%B4%EC%97%AC%EC%A7%84%EB%8B%A4\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E오케스트레이션 Saga 모델링 결과는 다음과 같이 보여진다.\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229645326-3a24d5e3-81f3-4ecb-9e6f-2101302eb697.png\" alt=\"image\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"code-생성-및-내-git-리파지토리에-푸쉬\"\u003E\u003Ca href=\"#code-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EB%82%B4-git-%EB%A6%AC%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC%EC%97%90-%ED%91%B8%EC%89%AC\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECode 생성 및 내 Git 리파지토리에 푸쉬\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003ECode Preview \u003E Git 아이콘을 눌러 내 레파지토리에 푸쉬한다.\n\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229663138-ec1a8a2c-a50f-4c3c-ba4c-75c1ea9057ad.png\" alt=\"image\"\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229649084-15d388b9-3246-43b2-956c-d1012f47ce12.png\" alt=\"image\"\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EGitPod 환경에서 로딩한다.\n\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229649200-cd48e7fb-54bb-46af-9806-0f893d9375bb.png\" alt=\"image\"\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"axon-server-확인\"\u003E\u003Ca href=\"#axon-server-%ED%99%95%EC%9D%B8\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAxon Server 확인\u003C\u002Fh3\u003E\n\u003Ch4 id=\"infra--docker-composeyml\"\u003E\u003Ca href=\"#infra--docker-composeyml\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Einfra \u003E docker-compose.yml\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EAxon Server는 대시보드를 위한 8024, 메시지 gRPC를 위한 8124 포트를 사용한다.\u003C\u002Fli\u003E\n\u003Cli\u003E각 서비스들의 Offset Token 관리를 위한 Token Store(MySQL)가 Lab 실행시 생성된다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"orchestration-saga-code-completion\"\u003E\u003Ca href=\"#orchestration-saga-code-completion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOrchestration Saga Code Completion\u003C\u002Fh2\u003E\n\u003Ch3 id=\"product-service\"\u003E\u003Ca href=\"#product-service\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EProduct Service\u003C\u002Fh3\u003E\n\u003Cp\u003E상품 Domain 코드에 Biz 로직을 완성한다.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E재고 부족시 도메인 오류 발생코드를 추가한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# ProductAggregate - @DecreaseStockCommand 재고부족시 Exception 발생 \n\tif(this.getStock() &lt; command.getStock()) throw new IllegalStateException(&quot;Out of Stock. !&quot;);  \u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003Eproduct \u003E ProductAggregate.java 내 다음 코드를 추가한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# @EventSourcingHandler :: StockIncreasedEvent : \n    setStock(getStock() + event.getStock());  \u002F\u002F 코드추가\n\n#  @EventSourcingHandler :: StockDecreasedEvent : \n    setStock(getStock() - event.getStock());  \u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"order-service\"\u003E\u003Ca href=\"#order-service\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOrder Service\u003C\u002Fh3\u003E\n\u003Cp\u003E주문 Domain 코드에 Biz 로직을 완성한다.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eorder \u003E OrderAggregate.java 내 다음 코드를 추가한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# @EventSourcingHandler :: OrderPlacedEvent :\n     setStatus(&quot;OrderPlaced&quot;); \t\t\t\u002F\u002F 코드추가\n# @EventSourcingHandler :: OrderCompletedEvent : \n     setStatus(&quot;OrderCompleted&quot;); \t\t\u002F\u002F 코드추가\n# @EventSourcingHandler :: OrderCancelledEvent :      \n      setStatus(&quot;OrderCancelled&quot;);\t\t\u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"delivery-service\"\u003E\u003Ca href=\"#delivery-service\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDelivery Service\u003C\u002Fh3\u003E\n\u003Cp\u003E배송 Domain 코드에 Biz 로직을 완성한다.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Edelivery \u003E DeliveryAggregate.java 내 다음 코드를 추가한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# @EventSourcingHandler :: DeliveryStartedEvent :\n      setStatus(&quot;DeliveryStarted&quot;); \t\t\u002F\u002F 코드추가\n# @EventSourcingHandler :: DeliveryCancelledEvent : \n      setStatus(&quot;DeliveryCancelled&quot;); \t\t\u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"ordersaga\"\u003E\u003Ca href=\"#ordersaga\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOrderSaga\u003C\u002Fh3\u003E\n\u003Cp\u003E주문 오케스트레이션을 수행하도록 OrderSaga 코드를 완성한다.\u003C\u002Fp\u003E\n\u003Ch4 id=\"1-saga-start\"\u003E\u003Ca href=\"#1-saga-start\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E1. Saga Start\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EOrderPlaced 이벤트로부터 Correlation key 설정 : 24 라인\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E\t@SagaEventHandler(associationProperty = &quot;orderId&quot;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"2-배송시작-command-생성-및-호출--27라인\"\u003E\u003Ca href=\"#2-%EB%B0%B0%EC%86%A1%EC%8B%9C%EC%9E%91-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C--27%EB%9D%BC%EC%9D%B8\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E2. 배송시작 Command 생성 및 호출 : 27라인\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ecommand.setOrderId(event.getOrderId());\ncommand.setProductId(event.getProductId());\ncommand.setQty(event.getQty());\ncommand.setUserId(event.getUserId());\n\n# 배송실패시, 주문취소 Compensation 처리 : OrderCancelCommand\norderCancelCommand.setOrderId(event.getOrderId());  \t\u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"3-deliverystartedevent-이벤트로부터-correlation-key-설정\"\u003E\u003Ca href=\"#3-deliverystartedevent-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A1%9C%EB%B6%80%ED%84%B0-correlation-key-%EC%84%A4%EC%A0%95\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E3. DeliveryStartedEvent 이벤트로부터 Correlation key 설정\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E\t@SagaEventHandler(associationProperty = &quot;orderId&quot;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"4-재고차감-command-생성-및-호출\"\u003E\u003Ca href=\"#4-%EC%9E%AC%EA%B3%A0%EC%B0%A8%EA%B0%90-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E4. 재고차감 Command 생성 및 호출\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ecommand.setProductId(event.getProductId());\ncommand.setStock(event.getQty());\t\ncommand.setOrderId(event.getOrderId());\n\n# 재고차감 실패시, 배송취소 Compensation 처리 : CancelDeliveryCommand\ncancelDeliveryCommand.setDeliveryId(event.getDeliveryId());\t\u002F\u002F 코드추가\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"5-stockdecreasedevent-이벤트로부터-correlation-key-설정\"\u003E\u003Ca href=\"#5-stockdecreasedevent-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A1%9C%EB%B6%80%ED%84%B0-correlation-key-%EC%84%A4%EC%A0%95\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E5. StockDecreasedEvent 이벤트로부터 Correlation key 설정\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E\t@SagaEventHandler(associationProperty = &quot;orderId&quot;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"6-주문완료-command-생성-및-호출\"\u003E\u003Ca href=\"#6-%EC%A3%BC%EB%AC%B8%EC%99%84%EB%A3%8C-command-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%98%B8%EC%B6%9C\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E6. 주문완료 Command 생성 및 호출\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ecommand.setOrderId(event.getOrderId());\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch4 id=\"7-saga-end\"\u003E\u003Ca href=\"#7-saga-end\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E7. Saga End\u003C\u002Fh4\u003E\n\u003Cul\u003E\n\u003Cli\u003EOrderCompletedEvent 이벤트로부터 Correlation key 설정\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E\t@SagaEventHandler(associationProperty = &quot;orderId&quot;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003ESaga Process 종료\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"12st-mall-테스트\"\u003E\u003Ca href=\"#12st-mall-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E12st Mall 테스트\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003ERest API를 활용해 생성된 Axon Saga 기반 몰을 테스트 한다.\u003C\u002Fli\u003E\n\u003Cli\u003E먼저 Common API를 빌드한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ecd common-api\nmvn clean install\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E각 마이크로 서비스를 실행한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# new terminal\ncd order\nmvn clean spring-boot:run\n\n# new terminal\ncd product\nmvn clean spring-boot:run\n\n# new terminal\ncd delivery\nmvn clean spring-boot:run\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E상품서비스(:8082)에 테스트용 상품을 등록한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E# new terminal\nhttp POST :8082\u002Fproducts productName=TV stock=100\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E등록된 상품 Id를 복사해 둔다.\n\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229345799-6a86743c-d3b1-43b7-9a94-91c4e50cfd9b.png\" alt=\"image\"\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E복사한 상품 Id로 10개의 TV를 구매하는 주문을 생성한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ehttp POST :8081\u002Forders productId=[상품 Id] productName=TV qty=10 userId=1001\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E생성된 주문 Id를 복사해 둔다.\n\u003Cimg src=\"https:\u002F\u002Fuser-images.githubusercontent.com\u002F35618409\u002F229346264-89d2c227-5dc8-454d-acb0-1c24bc0da63d.png\" alt=\"image\"\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"12st-mall-saga-compensation-검증\"\u003E\u003Ca href=\"#12st-mall-saga-compensation-%EA%B2%80%EC%A6%9D\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E12st Mall Saga Compensation 검증\u003C\u002Fh2\u003E\n\u003Ch3 id=\"주문-생성\"\u003E\u003Ca href=\"#%EC%A3%BC%EB%AC%B8-%EC%83%9D%EC%84%B1\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E주문 생성\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E상품 Id로 100개의 TV를 구매하는 주문을 생성하고 주문번호를 복사해 두자.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ehttp POST :8081\u002Forders productId=[상품 Id] productName=TV qty=100 userId=1001\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E재고 개수(90)보다 많은 주문으로 상품서비스에서 오류를 리턴한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003E주문 번호로 생성된 주문의 최종 상태와 이벤트 이력을 조회해 본다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ehttp GET :8081\u002Forders\u002F[주문번호]\nhttp GET :8081\u002Forders\u002F[주문번호]\u002Fevents\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E배송서비스의 배송 상태를 조회해 본다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Ehttp GET :8083\u002Fdeliveries\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"확장-미션---주문서비스-debugging\"\u003E\u003Ca href=\"#%ED%99%95%EC%9E%A5-%EB%AF%B8%EC%85%98---%EC%A3%BC%EB%AC%B8%EC%84%9C%EB%B9%84%EC%8A%A4-debugging\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E[확장 미션] - 주문서비스 Debugging\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E주문서비스를 종료한다.\u003C\u002Fli\u003E\n\u003Cli\u003EOrderSaga 에 SagaEventHandler별로 Break Points를 추가한다.\u003C\u002Fli\u003E\n\u003Cli\u003E주문서비스를 디버그 모드로 실행한다.\u003C\u002Fli\u003E\n\u003Cli\u003E새로운 주문을 생성한 다음 Debug Point를 확인하면서 Orchestration 흐름을 식별한다.\u003C\u002Fli\u003E\n\u003Cli\u003E재고보다 많은 수량을 넣어 Debug Point를 확인한다.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n","sidebar":"started","next":"","prev":"","headings":[{"depth":1,"value":"Choreography Saga","anchor":"#choreography-saga"},{"depth":3,"value":"이벤트스토밍 모델 준비","anchor":"#이벤트스토밍-모델-준비"},{"depth":3,"value":"Orchestration Saga 시나리오","anchor":"#orchestration-saga-시나리오"},{"depth":3,"value":"Saga Modeling","anchor":"#saga-modeling"},{"depth":3,"value":"Process Orchestration","anchor":"#process-orchestration"},{"depth":4,"value":"오케스트레이션 Saga 모델링 결과는 다음과 같이 보여진다.","anchor":"#오케스트레이션-saga-모델링-결과는-다음과-같이-보여진다"},{"depth":3,"value":"Code 생성 및 내 Git 리파지토리에 푸쉬","anchor":"#code-생성-및-내-git-리파지토리에-푸쉬"},{"depth":3,"value":"Axon Server 확인","anchor":"#axon-server-확인"},{"depth":4,"value":"infra \u003E docker-compose.yml","anchor":"#infra--docker-composeyml"},{"depth":2,"value":"Orchestration Saga Code Completion","anchor":"#orchestration-saga-code-completion"},{"depth":3,"value":"Product Service","anchor":"#product-service"},{"depth":3,"value":"Order Service","anchor":"#order-service"},{"depth":3,"value":"Delivery Service","anchor":"#delivery-service"},{"depth":3,"value":"OrderSaga","anchor":"#ordersaga"},{"depth":4,"value":"1. Saga Start","anchor":"#1-saga-start"},{"depth":4,"value":"2. 배송시작 Command 생성 및 호출 : 27라인","anchor":"#2-배송시작-command-생성-및-호출--27라인"},{"depth":4,"value":"3. DeliveryStartedEvent 이벤트로부터 Correlation key 설정","anchor":"#3-deliverystartedevent-이벤트로부터-correlation-key-설정"},{"depth":4,"value":"4. 재고차감 Command 생성 및 호출","anchor":"#4-재고차감-command-생성-및-호출"},{"depth":4,"value":"5. StockDecreasedEvent 이벤트로부터 Correlation key 설정","anchor":"#5-stockdecreasedevent-이벤트로부터-correlation-key-설정"},{"depth":4,"value":"6. 주문완료 Command 생성 및 호출","anchor":"#6-주문완료-command-생성-및-호출"},{"depth":4,"value":"7. Saga End","anchor":"#7-saga-end"},{"depth":2,"value":"12st Mall 테스트","anchor":"#12st-mall-테스트"},{"depth":2,"value":"12st Mall Saga Compensation 검증","anchor":"#12st-mall-saga-compensation-검증"},{"depth":3,"value":"주문 생성","anchor":"#주문-생성"},{"depth":3,"value":" - 주문서비스 Debugging","anchor":"#확장-미션---주문서비스-debugging"}]},"allMarkdownPage":{"edges":[{"node":{"path":"\u002Ftool\u002Fsetup-on-prem\u002F","title":"Running on Docker Compose (with Github)"}},{"node":{"path":"\u002Ftool\u002Fk8s-modeling\u002F","title":"K8s 배포 모델링"}},{"node":{"path":"\u002Ftool\u002Fon-prem-inst\u002F","title":"on-prem 설치 설명서"}},{"node":{"path":"\u002Ftool\u002Fsi-gpt\u002F","title":"ChatGPT 기반 구현 및 디버깅 자동화"}},{"node":{"path":"\u002Ftool\u002Fmodel-driven\u002F","title":"코드 생성"}},{"node":{"path":"\u002Ftool\u002Fmarketplace\u002F","title":"마켓플레이스"}},{"node":{"path":"\u002Ftool\u002Fevent-storming-tool\u002F","title":"이벤트스토밍"}},{"node":{"path":"\u002Ftool\u002Finfrastructure-modeling\u002F","title":"인프라 모델링 (쿠버네티스)"}},{"node":{"path":"\u002Fstarted\u002Fdomain-driven\u002F","title":"도메인 주도 설계 학습"}},{"node":{"path":"\u002Ftool\u002Fgoogle-drive-examples\u002F","title":"Quick Start"}},{"node":{"path":"\u002Ftool\u002Fchat-gpt\u002F","title":"ChatGPT 기반 모델 생성"}},{"node":{"path":"\u002Ftool\u002Fdevelopment-practice\u002F","title":"강의 개발 및 실습 환경"}},{"node":{"path":"\u002Ftool\u002Fcloud-ide-tool\u002F","title":"클라우드 IDE"}},{"node":{"path":"\u002Ftemplates-language\u002Fspringboot-java-template\u002F","title":"Spring Boot\u002FJava Template(준비중)"}},{"node":{"path":"\u002Fstarted\u002Fkey-features\u002F","title":"주요 기능"}},{"node":{"path":"\u002Fstarted\u002F","title":"소개"}},{"node":{"path":"\u002Ftool\u002Fattending-lectures\u002F","title":"Attending lectures"}},{"node":{"path":"\u002Fstarted\u002Fevent-storming-learning\u002F","title":"이벤트스토밍 학습"}},{"node":{"path":"\u002Ftemplates-language\u002Fgo-template\u002F","title":"Go Template"}},{"node":{"path":"\u002Foperation\u002Fops-deploy-diagramming-advanced-ingress\u002F","title":"Ingress 배포모델 설계"}},{"node":{"path":"\u002Foperation\u002Fops-deploy-diagramming-basic-objects\u002F","title":"12st Mall Basic Deploy"}},{"node":{"path":"\u002Ftemplates-language\u002Fpython-template\u002F","title":"Python Template "}},{"node":{"path":"\u002Foperation\u002Fops-deploy-diagramming-advanced-istio\u002F","title":"Istio Mesh"}},{"node":{"path":"\u002Foperation\u002Fops-deploy-diagramming-advanced-pvc\u002F","title":"Persistent Volume"}},{"node":{"path":"\u002Foperation\u002Fops-deploy-diagramming-advanced-hpa\u002F","title":"자동확장(HPA) 배포"}},{"node":{"path":"\u002Fdevelopment\u002Fpub-sub\u002F","title":"Pub\u002FSub 방식의 연동 "}},{"node":{"path":"\u002Fdevelopment\u002Fmonolith-2-misvc\u002F","title":"Req\u002FRes 방식의 MSA 연동 "}},{"node":{"path":"\u002Fdevelopment\u002Foauth2with-keycloak\u002F","title":"JWT Token 기반 인증 인가"}},{"node":{"path":"\u002Fdevelopment\u002Fops-docker\u002F","title":"Application Packaging with Container (Docker)"}},{"node":{"path":"\u002Fdevelopment\u002Funderstanding-jpa-based-single-microservice\u002F","title":"마이크로서비스 구현 및 동작원리 이해"}},{"node":{"path":"\u002Fdevelopment\u002Ftoken-based-auth\u002F","title":"JWT Token 기반 인증 인가"}},{"node":{"path":"\u002Fdevelopment\u002Fpubsub-deadline\u002F","title":"Pub\u002FSub 방식의 연동 - Choreography with Deadline added"}},{"node":{"path":"\u002Fdevelopment\u002Fpubsub-idempotency\u002F","title":"Pub\u002FSub 방식의 연동 - Choreography with Idempotency"}},{"node":{"path":"\u002Fdevelopment\u002Forchestration-saga\u002F","title":"Orchestration Saga with Axon Framework"}},{"node":{"path":"\u002Fdevelopment\u002Fkafka-scaling\u002F","title":"Kafka Scaling "}},{"node":{"path":"\u002Fdevelopment\u002Fkafka-retry-dlq\u002F","title":"Kafka Retry & Dead Letter Queue "}},{"node":{"path":"\u002Fdevelopment\u002Fkafka-scaling-concurrenty-handling\u002F","title":"Kafka scaling & Concurrenty handling"}},{"node":{"path":"\u002Fdevelopment\u002Fkafka-connect\u002F","title":"CDC(Change Data Capture) with Kafka"}},{"node":{"path":"\u002Fdevelopment\u002Fdp-graphql\u002F","title":"Data Projection with GraphQL"}},{"node":{"path":"\u002Fdevelopment\u002Fgateway\u002F","title":"API Gateway"}},{"node":{"path":"\u002Fdevelopment\u002Fdp-cqrs\u002F","title":"Data Projection with CQRS"}},{"node":{"path":"\u002Fdevelopment\u002Fkafka-basic\u002F","title":"Kafka 기본 명령어 "}},{"node":{"path":"\u002Fdevelopment\u002Fdp-frontend\u002F","title":"Data Projection with Frontend and HATEOAS"}},{"node":{"path":"\u002Fdevelopment\u002Fconteact-messaging\u002F","title":"Conteact Test by Message-based CDC"}},{"node":{"path":"\u002Fdevelopment\u002Fcontract-test\u002F","title":"Contract Test (Consumer Driven Test)"}},{"node":{"path":"\u002Fdevelopment\u002Fchoreography-saga\u002F","title":"Choreography Saga"}},{"node":{"path":"\u002Fdevelopment\u002Fcircuit-breaker\u002F","title":"Req\u002FRes 방식에서 장애전파 차단 - 서킷브레이커 "}},{"node":{"path":"\u002Fdevelopment\u002Fcompensation-correlation\u002F","title":"Pub\u002FSub 방식의 연동 - Compensation 과 Correlation"}},{"node":{"path":"\u002Fdevelopment\u002Fcna-start\u002F","title":"단위 마이크로 서비스의 실행 "}},{"node":{"path":"\u002Fexample-scenario\u002Flibrary-system\u002F","title":"도서관 시스템"}},{"node":{"path":"\u002Fcustom-template\u002Ftutorial\u002F","title":"커스텀 템플릿 개념"}},{"node":{"path":"\u002Fexample-scenario\u002Fonline-lecture\u002F","title":"인터넷 강의수강 시스템"}},{"node":{"path":"\u002Fexample-scenario\u002Ffood-delivery\u002F","title":"음식배달"}},{"node":{"path":"\u002Fexample-scenario\u002Fanimal-hospital\u002F","title":"동물병원 진료시스템"}},{"node":{"path":"\u002Fexample-scenario\u002Faccommodation-reservation\u002F","title":"숙소예약"}},{"node":{"path":"\u002Fcustom-template\u002Funderstanding-template-structure\u002F","title":"템플릿 구조의 이해"}},{"node":{"path":"\u002Fcustom-template\u002Funit-test\u002F","title":"테스트 자동화"}},{"node":{"path":"\u002Fcustom-template\u002Ftemplate-syntax\u002F","title":"Template 문법의 이해"}},{"node":{"path":"\u002Fcustom-template\u002Ftemplate-structure\u002F","title":"템플릿 구조"}},{"node":{"path":"\u002Fcustom-template\u002Ftemplate-editor\u002F","title":"Template Editor"}},{"node":{"path":"\u002Fcustom-template\u002Fhelper\u002F","title":"Helper"}},{"node":{"path":"\u002Fcustom-template\u002Fmock-server\u002F","title":"Open API 3.0 기반 목 서버 생성 토핑(New)"}},{"node":{"path":"\u002Fcustom-template\u002Fdesigning-template-helper\u002F","title":"Built-in Helper functions"}},{"node":{"path":"\u002Fcustom-template\u002Ffor-loop\u002F","title":"반복문"}},{"node":{"path":"\u002Fcustom-template\u002Fcustom-template\u002F","title":"Eventstorming Template Objects"}},{"node":{"path":"\u002Fcustom-template\u002Fconditional-statement\u002F","title":"조건문"}},{"node":{"path":"\u002Fcustom-template\u002Fcreating-custom-template-1\u002F","title":"커스텀 템플릿 생성"}},{"node":{"path":"\u002Fbusiness\u002F","title":"이벤트스토밍 - 쇼핑몰 예제"}},{"node":{"path":"\u002Fcontact\u002Fquestion\u002F","title":"CONTACT"}},{"node":{"path":"\u002Fbusiness\u002Feventstorming-fooddelivery\u002F","title":"[이벤트스토밍] - DDD Food Delivery 예제"}},{"node":{"path":"\u002Fbusiness\u002Fddd-google-drive\u002F","title":"[이벤트스토밍] - 구글 드라이브 예제"}}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.1d5c79dd.js" defer></script><script src="/assets/js/page--src--templates--markdown-page-vue.43dc86ca.js" defer></script>
  </body>
</html>
